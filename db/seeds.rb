require 'csv'

players = CSV.open('lib/nfl_stats_2014.csv', headers: true, header_converters: :symbol, converters: :all)
kickers = CSV.open('lib/nfl_stats_kickers_2014.csv', headers: true, header_converters: :symbol, converters: :all)
defenses = CSV.open('lib/nfl_stats_defenses_2014.csv', headers: true, header_converters: :symbol, converters: :all)

Player.transaction do
  players.to_a.each do |row|
    row[:birthdate] = Date.strptime(row[:birthdate], '%m/%d/%y')
    row[:age] = (Time.now.to_s(:number).to_i - row[:birthdate].to_time.to_s(:number).to_i)/10e9.to_i
    row[:team] = 'FA' unless row[:team]
    Player.create(row.to_hash)
  end

  kickers.to_a.each do |row|
    row[:birthdate] = Date.strptime(row[:birthdate], '%m/%d/%y')
    row[:age] = (Time.now.to_s(:number).to_i - row[:birthdate].to_time.to_s(:number).to_i)/10e9.to_i
    row[:team] = 'FA' unless row[:team]
    Player.create(row.to_hash)
  end

  defenses.to_a.each do |row|
    Player.create(row.to_hash)
  end
end

user = User.create(email: 'test@example.com', password: 'test123', provider: 'email', admin: true)
User.create(email: 'test2@example.com', password: 'test123', provider: 'email')
User.create(email: 'test3@example.com', password: 'test123', provider: 'email')

# set player ranks
['QB', 'RB', 'WR', 'TE', 'DEF', 'K'].each do |position|
  Player.transaction do
    players = Player.where(position: position).order(points: :desc)
    players.each_with_index do |player, idx|
      player.update(pos_rank: idx + 1)
    end
  end
end

test_collection = user.collections.create(name: 'All Rankings', default: false)
test_collection.sheets.create!(position: 'QB', ranks: [1, 2, 3, 4, 5, 6, 7, 17, 11, 9, 8, 10, 12, 15, 14, 53, 31, 22, 16, 13, 51, 18, 52, 19, 36, 29, 20, 24, 21, 48, 28, 54, 41, 26, 45, 55, 25, 27, 35, 49, 56, 42, 33, 38, 58, 32, 34, 50, 30, 59, 57, 23, 37, 39, 40, 43, 44, 46, 47])
test_collection.sheets.create!(position: 'RB', ranks: [65, 61, 66, 160, 62, 64, 70, 63, 60, 71, 69, 74, 72, 68, 113, 67, 162, 82, 75, 73, 180, 106, 163, 164, 79, 77, 89, 132, 96, 87, 125, 98, 78, 119, 86, 84, 107, 165, 135, 120, 102, 91, 80, 112, 83, 148, 150, 92, 115, 95, 108, 166, 109, 167, 168, 90, 161, 169, 170, 140, 99, 122, 121, 97, 128, 171, 172, 173, 88, 85, 104, 133, 93, 159, 177, 139, 181, 117, 118, 94, 176, 100, 131, 114, 76, 105, 111, 154, 143, 124, 179, 103, 130, 126, 178, 146, 175, 116, 174, 101, 123, 141, 134, 142, 152, 127, 129, 147, 138, 156, 158, 110, 136, 137, 144, 145, 149, 81, 151, 153, 155, 157])
test_collection.sheets.create!(position: 'WR', ranks: [182, 185, 184, 186, 183, 189, 195, 204, 192, 187, 193, 191, 188, 198, 196, 238, 205, 208, 206, 228, 197, 219, 282, 194, 222, 214, 283, 199, 190, 230, 250, 209, 203, 284, 213, 207, 223, 200, 285, 262, 236, 212, 239, 218, 254, 286, 287, 252, 201, 278, 202, 227, 210, 225, 288, 266, 221, 273, 235, 289, 290, 217, 291, 292, 293, 216, 233, 243, 232, 294, 295, 257, 248, 296, 259, 297, 260, 256, 231, 224, 220, 240, 306, 258, 305, 304, 241, 303, 264, 302, 229, 301, 300, 215, 299, 269, 244, 298, 261, 234, 245, 246, 255, 249, 211, 251, 226, 237, 242, 247, 253, 263, 279, 265, 267, 268, 270, 271, 272, 274, 275, 276, 277, 280, 281])
test_collection.sheets.create!(position: 'TE', ranks: [307, 309, 310, 315, 311, 308, 313, 316, 320, 319, 330, 314, 333, 318, 323, 336, 349, 343, 317, 322, 312, 351, 363, 335, 357, 342, 346, 358, 321, 325, 362, 359, 340, 360, 326, 341, 361, 355, 329, 332, 345, 324, 327, 328, 331, 334, 338, 337, 339, 344, 347, 348, 350, 352, 353, 354, 356])
test_collection.sheets.create!(position: 'DEF', ranks: [403, 400, 399, 401, 426, 415, 404, 413, 406, 411, 408, 405, 402, 417, 398, 410, 409, 412, 421, 407, 420, 419, 423, 416, 414, 418, 427, 425, 422, 424, 428, 429])
test_collection.sheets.create!(position: 'K', ranks: [364, 366, 372, 395, 373, 365, 391, 370, 369, 367, 368, 375, 374, 382, 379, 385, 380, 371, 376, 377, 383, 384, 378, 381, 387, 388, 390, 392, 393, 396, 394, 386, 389, 397])

fp_standard = user.collections.create(name: 'FantasyPros Consensus Standard Rankings', default: true)
fp_standard.sheets.create!(position: 'QB', ranks: [2, 1, 3, 4, 5, 17, 6, 7, 11, 9, 15, 8, 10, 12, 14, 22, 53, 16, 31, 13, 36, 19, 51, 20, 18, 52, 29, 24, 26, 21, 27, 25, 45, 54, 55, 41, 48, 28, 34, 38])
fp_standard.sheets.create!(position: 'RB', ranks: [66, 160, 65, 61, 62, 63, 64, 71, 60, 70, 69, 72, 67, 74, 113, 162, 68, 75, 82, 79, 106, 163, 180, 73, 96, 132, 77, 164, 87, 125, 89, 78, 165, 135, 98, 120, 107, 86, 119, 84, 102, 167, 80, 91, 169, 172, 109, 168, 161, 83, 92, 97, 90, 150, 108, 95, 148, 128, 115, 177, 112, 170, 88, 94, 99, 85, 173, 166, 105, 122, 114, 131, 146, 100, 175, 118, 110, 93, 121, 101, 81, 104, 176, 171, 181, 134, 130, 117, 111, 154, 159, 143, 103, 140, 116, 141, 147, 127, 178, 133])
fp_standard.sheets.create!(position: 'WR', ranks: [182, 184, 185, 186, 183, 189, 195, 204, 192, 187, 191, 193, 196, 198, 188, 238, 205, 197, 222, 208, 228, 214, 206, 194, 282, 219, 190, 223, 207, 213, 230, 199, 283, 209, 262, 200, 236, 203, 250, 201, 284, 202, 212, 285, 239, 278, 227, 218, 286, 235, 217, 221, 254, 287, 216, 266, 243, 225, 252, 210, 288, 289, 273, 257, 233, 292, 232, 260, 269, 251, 302, 290, 248, 295, 274, 220, 259, 237, 303, 264, 263, 224, 256, 291, 215, 293, 211, 297, 244, 231, 249, 261, 258, 299, 229, 294, 240, 241, 304, 305])
fp_standard.sheets.create!(position: 'TE', ranks: [307, 309, 315, 310, 311, 308, 320, 330, 313, 314, 316, 333, 319, 323, 318, 336, 343, 312, 349, 363, 317, 322, 342, 351, 325, 335, 321, 362, 346, 360, 357, 355, 329, 358, 359, 345, 341, 326, 340, 332])
fp_standard.sheets.create!(position: 'DEF', ranks: [403, 400, 401, 399, 406, 415, 405, 417, 404, 426, 402, 413, 421, 412, 408, 398, 409, 410, 411, 414, 416, 407, 418, 419, 420, 423, 424, 427, 422, 428, 425, 429])
fp_standard.sheets.create!(position: 'K', ranks: [364, 372, 373, 366, 368, 369, 365, 395, 370, 385, 391, 375, 382, 367, 374, 379, 380, 371, 383, 396, 378, 397, 377, 381, 376, 390, 384, 387, 388, 392, 393, 386])

fp_ppr = user.collections.create(name: 'FantasyPros Consensus PPR Rankings', default: true, ppr: 1)
fp_ppr.sheets.create!(position: 'QB', ranks: [2, 1, 3, 4, 5, 17, 6, 7, 11, 9, 15, 8, 10, 12, 14, 22, 53, 16, 31, 13, 36, 19, 51, 20, 18, 52, 29, 24, 26, 21, 27, 25, 45, 54, 55, 41, 48, 28, 34, 38])
fp_ppr.sheets.create!(position: 'RB', ranks: [66, 61, 160, 63, 65, 64, 62, 71, 70, 60, 69, 67, 75, 68, 74, 132, 72, 79, 113, 162, 82, 77, 163, 106, 180, 73, 164, 96, 89, 87, 165, 86, 125, 135, 120, 98, 78, 107, 109, 119, 102, 84, 161, 172, 167, 90, 97, 169, 83, 168, 91, 80, 92, 170, 94, 177, 88, 128, 148, 108, 150, 173, 114, 95, 131, 166, 115, 99, 140, 175, 105, 118, 100, 122, 104, 112, 93, 101, 110, 121, 176, 81, 181, 171, 117, 146, 130, 159, 141, 116, 134, 154, 143, 85, 147, 178, 103, 127, 137, 153])
fp_ppr.sheets.create!(position: 'WR', ranks: [182, 185, 189, 186, 184, 195, 183, 204, 192, 187, 191, 193, 196, 198, 188, 238, 208, 205, 222, 228, 214, 194, 197, 206, 190, 282, 219, 207, 230, 223, 213, 209, 199, 250, 200, 236, 203, 283, 262, 202, 201, 284, 218, 278, 239, 212, 235, 227, 285, 286, 217, 254, 287, 243, 216, 221, 266, 225, 233, 289, 273, 252, 288, 257, 231, 260, 292, 269, 274, 210, 251, 306, 290, 248, 295, 259, 302, 220, 249, 237, 305, 224, 263, 215, 264, 294, 291, 232, 211, 293, 229, 258, 256, 261, 244, 304, 241, 240, 303, 297])
fp_ppr.sheets.create!(position: 'TE', ranks: [307, 309, 310, 315, 311, 308, 330, 320, 313, 314, 316, 333, 319, 323, 336, 318, 343, 312, 317, 363, 349, 322, 325, 342, 351, 335, 321, 346, 362, 360, 357, 355, 358, 359, 345, 326, 329, 341, 340, 332])
fp_ppr.sheets.create!(position: 'DEF', ranks: [403, 400, 401, 399, 406, 415, 405, 417, 404, 426, 402, 413, 421, 412, 408, 398, 409, 410, 411, 414, 416, 407, 418, 419, 420, 423, 424, 427, 422, 428, 425, 429])
fp_ppr.sheets.create!(position: 'K', ranks: [364, 372, 373, 366, 368, 369, 365, 395, 370, 385, 391, 375, 382, 367, 374, 379, 380, 371, 383, 396, 378, 397, 377, 381, 376, 390, 384, 387, 388, 392, 393, 386])

espn_rankings = user.collections.create(name: 'ESPN Staff Rankings', default: true)
espn_rankings.sheets.create!(position: 'QB', ranks: [1, 2, 3, 4, 5, 6, 7, 17, 11, 9, 8, 10, 12, 15, 14, 53, 31, 22, 16, 13, 51, 18, 52, 19, 36, 29, 20, 24, 21, 48, 28, 54, 41, 26, 45, 55, 25, 27, 35, 49])
espn_rankings.sheets.create!(position: 'RB', ranks: [65, 61, 66, 160, 62, 64, 70, 63, 60, 71, 69, 74, 72, 68, 113, 67, 162, 82, 75, 73, 106, 163, 180, 164, 79, 77, 89, 132, 96, 87, 125, 98, 78, 119, 86, 84, 107, 165, 135, 120, 102, 91, 80, 112, 83, 148, 150, 92, 115, 95, 108, 166, 109, 167, 168, 90, 161, 169, 170, 140, 99, 122, 121, 97, 128, 171, 172, 173, 88, 85, 104, 133, 93, 159, 181, 177, 139, 117, 118, 94, 176, 100, 131, 114, 76, 105, 111, 154, 143, 124, 179, 103, 130, 126, 178, 146, 175, 116, 174, 101])
espn_rankings.sheets.create!(position: 'WR', ranks: [182, 185, 184, 186, 183, 189, 195, 204, 192, 187, 193, 191, 188, 198, 196, 238, 205, 208, 206, 228, 197, 219, 282, 194, 222, 214, 283, 199, 190, 230, 250, 209, 203, 284, 213, 207, 223, 200, 285, 262, 236, 212, 239, 218, 254, 286, 287, 252, 201, 278, 202, 227, 210, 225, 288, 266, 221, 273, 235, 289, 290, 217, 291, 292, 293, 216, 233, 243, 232, 294, 295, 257, 248, 296, 259, 297, 260, 256, 231, 224, 220, 240, 306, 258, 305, 304, 241, 303, 264, 302, 229, 301, 300, 215, 299, 269, 244, 298, 261, 234])
espn_rankings.sheets.create!(position: 'TE', ranks: [307, 309, 310, 315, 311, 308, 313, 316, 320, 319, 330, 314, 333, 318, 323, 336, 349, 343, 317, 322, 312, 351, 363, 335, 357, 342, 346, 358, 321, 325, 362, 359, 340, 360, 326, 341, 361, 355, 329, 332])
espn_rankings.sheets.create!(position: 'DEF', ranks: [403, 400, 399, 401, 426, 415, 404, 413, 406, 411, 408, 405, 402, 417, 398, 410, 409, 412, 421, 407, 420, 419, 423, 416, 414, 418, 427, 425, 422, 424, 428, 429])
espn_rankings.sheets.create!(position: 'K', ranks: [364, 366, 372, 395, 373, 365, 391, 370, 369, 367, 368, 375, 374, 382, 379, 385, 380, 371, 376, 377, 383, 384, 378, 381, 387, 397, 388, 390, 392, 393, 396, 386])

mberry = user.collections.create(name: 'Matthew Berry Rankings', default: true)
mberry.sheets.create!(position: 'QB', ranks: [1, 2, 4, 3, 5, 7, 17, 8, 11, 6, 9, 10, 12, 15, 14, 31, 22, 53, 51, 16, 36, 18, 26, 19, 13, 24, 20, 52, 29, 54, 45, 28, 48, 27, 55, 21, 41, 25, 35, 49])
mberry.sheets.create!(position: 'RB', ranks: [66, 160, 62, 65, 61, 64, 60, 71, 63, 69, 70, 74, 72, 68, 67, 162, 82, 113, 164, 75, 106, 125, 79, 73, 163, 180, 77, 89, 96, 87, 165, 78, 135, 132, 119, 98, 86, 168, 95, 83, 102, 84, 107, 150, 122, 167, 112, 109, 120, 169, 92, 99, 105, 97, 128, 88, 118, 91, 177, 154, 90, 172, 148, 100, 161, 115, 80, 146, 143, 101, 108, 173, 121, 117, 137, 178, 159, 134, 141, 111, 166, 170, 181, 140, 171, 85, 104, 133, 93, 139, 94, 176, 131, 114, 76, 124, 179, 103, 130, 126])
mberry.sheets.create!(position: 'WR', ranks: [182, 185, 184, 183, 186, 189, 195, 204, 187, 188, 192, 193, 198, 191, 196, 222, 205, 208, 228, 219, 238, 283, 282, 214, 190, 197, 194, 262, 284, 199, 209, 206, 230, 200, 286, 207, 278, 212, 250, 236, 239, 223, 287, 285, 213, 201, 260, 221, 266, 243, 202, 210, 288, 254, 225, 218, 227, 235, 233, 273, 289, 292, 299, 291, 216, 293, 232, 211, 259, 252, 257, 256, 224, 261, 231, 220, 306, 241, 303, 215, 203, 290, 217, 294, 295, 248, 296, 297, 240, 258, 305, 304, 264, 302, 229, 301, 300, 269, 244, 298])
mberry.sheets.create!(position: 'TE', ranks: [307, 309, 310, 315, 308, 311, 314, 316, 319, 323, 330, 318, 313, 320, 333, 317, 336, 349, 343, 322, 312, 335, 342, 363, 357, 351, 346, 358, 321, 325, 362, 359, 340, 360, 326, 341, 361, 355, 329, 332])
mberry.sheets.create!(position: 'DEF', ranks: [403, 399, 401, 400, 415, 426, 406, 408, 413, 411, 417, 405, 398, 404, 416, 402, 421, 412, 409, 410, 414, 407, 420, 418, 419, 423, 422, 424, 428, 427, 425, 429])
mberry.sheets.create!(position: 'K', ranks: [364, 373, 366, 372, 368, 370, 369, 365, 395, 385, 367, 382, 391, 375, 380, 374, 371, 387, 378, 376, 379, 377, 383, 384, 381, 388, 390, 392, 393, 396, 394, 386])
